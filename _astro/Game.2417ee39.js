import{u as B,c as M,a as N,$ as z,b as J,d as Q,o as j,e as I,f as Z,g as $,h as D,i as y,j as ee,k as _,r as te,t as S,F as ne,S as V,l as ie,m as oe}from"./web.0abc60df.js";var W=()=>{};function re(e,n){const t=B(e),{onChange:c}=n;let i=new Set(n.appear?void 0:t);const s=new WeakSet,[l,d]=M([],{equals:!1}),[o]=J(),u=n.exitMethod==="remove"?W:a=>{d(r=>(r.push.apply(r,a),r));for(const r of a)s.delete(r)},x=n.exitMethod==="remove"?W:n.exitMethod==="keep-index"?(a,r,v)=>a.splice(v,0,r):(a,r)=>a.push(r);return N(a=>{const r=l(),v=e();if(v[z],B(o))return o(),a;if(r.length){const m=a.filter(h=>!r.includes(h));return r.length=0,c({list:m,added:[],removed:[],unchanged:m,finishRemoved:u}),m}return B(()=>{const m=new Set(v),h=v.slice(),f=[],k=[],p=[];for(const g of v)(i.has(g)?p:f).push(g);let b=!f.length;for(let g=0;g<a.length;g++){const E=a[g];m.has(E)||(s.has(E)||(k.push(E),s.add(E)),x(h,E,g)),b&&E!==h[g]&&(b=!1)}return!k.length&&b?a:(c({list:h,added:f,removed:k,unchanged:p,finishRemoved:u}),i=m,h)})},n.appear?[]:t.slice())}var Y=e=>e instanceof Element;function H(e,n){if(n(e))return e;if(typeof e=="function"&&!e.length)return H(e(),n);if(Array.isArray(e)){const t=[];for(const c of e){const i=H(c,n);i&&(Array.isArray(i)?t.push.apply(t,i):t.push(i))}return t.length?t:null}return null}function se(e,n=Y,t=Y){const c=N(e),i=N(()=>H(c(),n));return i.toArray=()=>{const s=i();return Array.isArray(s)?s:s?[s]:[]},i}function ae(e){return N(()=>{const n=e.name||"s";return{enterActive:(e.enterActiveClass||n+"-enter-active").split(" "),enter:(e.enterClass||n+"-enter").split(" "),enterTo:(e.enterToClass||n+"-enter-to").split(" "),exitActive:(e.exitActiveClass||n+"-exit-active").split(" "),exit:(e.exitClass||n+"-exit").split(" "),exitTo:(e.exitToClass||n+"-exit-to").split(" "),move:(e.moveClass||n+"-move").split(" ")}})}function U(e){requestAnimationFrame(()=>requestAnimationFrame(e))}function ce(e,n,t,c){const{onBeforeEnter:i,onEnter:s,onAfterEnter:l}=n;i?.(t),t.classList.add(...e.enter),t.classList.add(...e.enterActive),queueMicrotask(()=>{if(!t.parentNode)return c?.();s?.(t,()=>d())}),U(()=>{t.classList.remove(...e.enter),t.classList.add(...e.enterTo),(!s||s.length<2)&&(t.addEventListener("transitionend",d),t.addEventListener("animationend",d))});function d(o){(!o||o.target===t)&&(c?.(),t.removeEventListener("transitionend",d),t.removeEventListener("animationend",d),t.classList.remove(...e.enterActive),t.classList.remove(...e.enterTo),l?.(t))}}function le(e,n,t,c){const{onBeforeExit:i,onExit:s,onAfterExit:l}=n;if(!t.parentNode)return c?.();i?.(t),t.classList.add(...e.exit),t.classList.add(...e.exitActive),s?.(t,()=>d()),U(()=>{t.classList.remove(...e.exit),t.classList.add(...e.exitTo),(!s||s.length<2)&&(t.addEventListener("transitionend",d),t.addEventListener("animationend",d))});function d(o){(!o||o.target===t)&&(c?.(),t.removeEventListener("transitionend",d),t.removeEventListener("animationend",d),t.classList.remove(...e.exitActive),t.classList.remove(...e.exitTo),l?.(t))}}var de=e=>{const n=ae(e);return re(se(()=>e.children).toArray,{appear:e.appear,exitMethod:"keep-index",onChange({added:t,removed:c,finishRemoved:i,list:s}){const l=n();for(const o of t)ce(l,e,o);const d=[];for(const o of s)o.isConnected&&(o instanceof HTMLElement||o instanceof SVGElement)&&d.push({el:o,rect:o.getBoundingClientRect()});queueMicrotask(()=>{const o=[];for(const{el:u,rect:x}of d)if(u.isConnected){const a=u.getBoundingClientRect(),r=x.left-a.left,v=x.top-a.top;(r||v)&&(u.style.transform=`translate(${r}px, ${v}px)`,u.style.transitionDuration="0s",o.push(u))}document.body.offsetHeight;for(const u of o){let x=function(a){(a.target===u||/transform$/.test(a.propertyName))&&(u.removeEventListener("transitionend",x),u.classList.remove(...l.move))};u.classList.add(...l.move),u.style.transform=u.style.transitionDuration="",u.addEventListener("transitionend",x)}});for(const o of c)le(l,e,o,()=>i([o]))}})};function C(e){return[[e[0],e[1],e[2],e[3]],[e[4],e[5],e[6],e[7]],[e[8],e[9],e[10],e[11]],[e[12],e[13],e[14],e[15]]]}function R(e){return e.flat()}function G(e){return e.map(t=>[...t])}function ue(e){const n=G(e),t=e.length;return e.forEach((c,i)=>{c.forEach((s,l)=>{n[l][t-1-i]=s})}),n}function fe(e){const n=G(e),t=e.length;return e.forEach((c,i)=>{c.forEach((s,l)=>{n[t-1-l][i]=s})}),n}const O="highscore",w=4,T=e=>({value:e});function X(e,n=1){const t=[...e];let c=0;for(;c<n;){if(t.every(s=>s.value>0))return t;const i=Math.floor(Math.random()*t.length);t[i].value>0||(t[i]=T(Math.random()>.5?2:4),c++)}return t}function P(){const e=new Array(w*w).fill(0).map(n=>T(0));return X(e,2)}function F(e,n){const t=G(e);for(let c=0;c<w;c++){const i=t[c];let s=!0;for(let l=w-1-1;l>=0;l--){const d=i[l];if(d.value===0)continue;let o=l+1;for(;!(o>=w);){const u=i[o];if(s&&d.value===u.value){i[l]=T(0),i[o]=T(d.value*2),s=!1,n(d.value*2);break}if(u.value>0)break;o++}}for(let l=w-1-1;l>=0;l--){const d=i[l];if(d.value===0)continue;let o=l;for(;;){const u=i[o+1];if(!u||u.value>0||o===w-1)break;if(u.value===0)o+=1;else break}i[l]=T(0),i[o]=d}}return t}function ve(e,n){return e.length!==n.length?!1:e.every((t,c)=>n[c].value===t.value)}function he(){const[e,n]=M(P()),[t,c]=M(!1),[i,s]=M(0),[l,d]=M(0);function o(a){s(v=>v+a);const r=i();r>l()&&(localStorage.setItem(O,r.toString()),d(r))}function u(){n(P()),c(!1),s(0)}Q(()=>{e().some(a=>a.value===2048)&&c(!0)});function x(a){if(t())return;let r=0;function v(f){ve(e(),f)||(n(X(f)),o(r))}const m=fe,h=ue;switch(a){case"up":{const f=C(e()),k=h(f),p=F(k,E=>r+=E),b=m(p),g=R(b);v(g);break}case"down":{const f=C(e()),k=h(h(h(f))),p=F(k,E=>r+=E),b=m(m(m(p))),g=R(b);v(g);break}case"right":{const f=C(e()),k=F(f,b=>r+=b),p=R(k);v(p);break}case"left":{const f=C(e()),k=h(h(f)),p=F(k,E=>r+=E),b=m(m(p)),g=R(b);v(g);break}}}return j(()=>{d(+(localStorage.getItem(O)??"0"));const a=r=>{switch(r.key){case"ArrowUp":{x("up");break}case"ArrowDown":{x("down");break}case"ArrowRight":{x("right");break}case"ArrowLeft":{x("left");break}}};document.addEventListener("keydown",a),I(()=>{document.removeEventListener("keydown",a)})}),j(()=>{let a=null,r=null;function v(h){const[f]=h.touches;f&&(a=f.clientX,r=f.clientY)}function m(h){if(!a||!r)return;const[f]=h.touches;if(!f)return;const k=f.clientX,p=f.clientY,b=a-k,g=r-p;Math.abs(b)>Math.abs(g)?b>0?x("left"):x("right"):g>0?x("up"):x("down"),a=null,r=null}document.addEventListener("touchstart",v),document.addEventListener("touchmove",m),I(()=>{document.removeEventListener("touchstart",v),document.removeEventListener("touchend",m)})}),{field:e,hasWon:t,reset:u,score:i,highscore:l}}const ge=S('<div class="text-xl text-fuchsia-700 dark:text-fuchsia-500 font-semibold text-center mt-5">You have won!!!'),xe=S('<div><div class="text-center mb-5"><div class="text-lg font-medium text-blue-500 dark:text-blue-500">Score: <!$><!/></div><div class="text-lg font-medium text-fuchsia-700 dark:text-fuchsia-500">Highscore: <!$><!/></div></div><div class="flex justify-center mb-5"><button class="bg-blue-500 dark:bg-blue-300 text-white dark:text-black px-3 py-2 rounded">Reset</button></div><div class="select-none grid grid-cols-4 gap-2 bg-blue-100 dark:bg-blue-950 rounded-lg p-3 max-w-sm mx-auto"></div><!$><!/>'),me=S("<div>fallback"),be=S("<span>"),ke=S('<div class="group-item rounded text-2xl font-bold flex justify-center items-center w-full aspect-ratio-square">');function Ee(){const{field:e,hasWon:n,reset:t,score:c,highscore:i}=he();return(()=>{const s=$(xe),l=s.firstChild,d=l.firstChild,o=d.firstChild,u=o.nextSibling,[x,a]=D(u.nextSibling),r=d.nextSibling,v=r.firstChild,m=v.nextSibling,[h,f]=D(m.nextSibling),k=l.nextSibling,p=k.firstChild,b=k.nextSibling,g=b.nextSibling,[E,K]=D(g.nextSibling);return y(d,c,x,a),y(r,i,h,f),ee(p,"click",t,!0),y(b,_(de,{name:"group-item",get children(){return _(ne,{get each(){return e()},get fallback(){return $(me)},children:L=>(()=>{const q=$(ke);return y(q,_(V,{get when(){return L.value>0},get children(){const A=$(be);return y(A,()=>L.value),A}})),ie(A=>oe(q,{"bg-blue-200 dark:bg-blue-900":L.value===0,"bg-indigo-300 dark:bg-indigo-800 text-indigo-800 dark:text-indigo-400":L.value===2,"bg-indigo-400 dark:bg-indigo-700 text-indigo-900 dark:text-indigo-300":L.value===4,"bg-violet-300 dark:bg-violet-800 text-violet-800 dark:text-violet-400":L.value===8,"bg-violet-400 dark:bg-violet-700 text-violet-900 dark:text-violet-300":L.value===16,"bg-purple-300 dark:bg-purple-800 text-purple-800 dark:text-violet-400":L.value===32,"bg-purple-400 dark:bg-purple-700 text-purple-900 dark:text-violet-300":L.value===64,"bg-fuchsia-300 dark:bg-fuchsia-800 text-fuchsia-800 dark:text-fuchsia-400":L.value===128,"bg-fuchsia-400 dark:bg-fuchsia-700 text-fuchsia-900 dark:text-fuchsia-400":L.value===256,"bg-pink-300 dark:bg-pink-800 text-pink-800 dark:text-pink-400":L.value===512,"bg-pink-400 dark:bg-pink-700 text-pink-900 dark:text-pink-300":L.value===1024,"bg-red-500 dark:bg-red-600 text-red-900 dark:text-red-100":L.value===2048},A)),q})()})}})),y(s,_(V,{get when(){return n()},get children(){return $(ge)}}),E,K),te(),s})()}Z(["click"]);export{Ee as default};
